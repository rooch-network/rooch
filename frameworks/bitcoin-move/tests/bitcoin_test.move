#[test_only]
module bitcoin_move::bitcoin_test {

    use moveos_std::bcs;
    use bitcoin_move::types::{Self, Block};
    use bitcoin_move::bitcoin;

    #[test]
    fun test_submit_block() {
        bitcoin_move::genesis::init_for_test();

        //https://mempool.space/block/00000000b0c5a240b2a61d2e75692224efd4cbecdf6eaf4cc2cf477ca7c270e7
        let block_bytes = x"010000004ddccd549d28f385ab457e98d1b11ce80bfea2c5ab93015ade4973e400000000bf4473e53794beae34e64fccc471dace6ae544180816f89591894e0f417a914cd74d6e49ffff001d323b3a7b0221da2ae8cc773b020b4873f597369416cf961a1896c24106b0198459fec2df770100000000000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0804ffff001d026e04ffffffff000100f2052a0100000043410446ef0102d1ec5240f0d061a4246c1bdef63fc3dbab7733052fbbf0ecd8f41fc26bf049ebb4f9527f374280259e7cfa99c48b0e3f39c51347a19a5819651503a5ac1500bb4271dca9fae6473f4866b5982936f90ebd2abc339d9a371e2b5a26147ddfd87228b900ff75762a18a40f2778bedbcde7e9b0a301000000000000000321f75f3139a013f50f315b23b0c9a2b6eac31e2bec98e5891c924664889942260000000049483045022100cb2c6b346a978ab8c61b18b5e9397755cbd17d6eb2fe0083ef32e067fa6c785a02206ce44e613f31d9a6b0517e46f3db1576e9812cc98d159bfdaf759a5014081b5c01ffffffff0079cda0945903627c3da1f85fc95d0b8ee3e76ae0cfdc9a65d09744b1f8fc85430000000049483045022047957cdd957cfd0becd642f6b84d82f49b6cb4c51a91f49246908af7c3cfdf4a022100e96b46621f1bffcf5ea5982f88cef651e9354f5791602369bf5a82a6cd61a62501ffffffff00fe09f5fe3ffbf5ee97a54eb5e5069e9da6b4856ee86fc52938c2f979b0f38e82000000004847304402204165be9a4cbab8049e1af9723b96199bfd3e85f44c6b4c0177e3962686b26073022028f638da23fc003760861ad481ead4099312c60030d4cb57820ce4d33812a5ce01ffffffff0001009d966b01000000434104ea1feff861b51fe3f5f8a3b12d0f4712db80e919548a80839fc47c6a21e66d957e9c5d8cd108c7a2d2324bad71f9904ac0ae7336507d785b17a2c115e427a32fac15006fc51f2a519d341392c2231faec5e91881250b5a";
        let block: Block = bcs::from_bytes(block_bytes);

        let header = *types::header(&block);
        bitcoin::execute_l1_block_for_test(1, block);
        assert!(bitcoin::contains_header(&header), 1);
    }
}